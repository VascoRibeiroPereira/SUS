---
title: "BALANÇO ACTIVIDADES - EXERCICIO 2019"
author: "Vasco Pereira"
date: "`r Sys.Date()`"
output: md_document
  #pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

```{r bibliotecas}
library(dplyr)
library(ggplot2)
library(openxlsx)
```

# Centros de Custo e Rubricas Associadas

```{r centros de custo e rubricas}
setwd("/Users/vascoalbertofiliperibeiro/R/SUS")
ccRubri <- read.delim("./CentrosdeCusto.csv", sep = ";")
ccRubri <- ccRubri %>% arrange(CENTRO.DE.CUSTO)
knitr::kable(ccRubri)
```

# Balanço de Atividades por Centro de Custo

```{r ler dados}
dados2019 <- tibble()
setwd("/Users/vascoalbertofiliperibeiro/R/SUS")
for (i in 1:12) {
        dadosTMP <- read.xlsx("./2019/tabelas_por_mes/tabelas_Final.xlsx", 
                              sheet = i, detectDates = TRUE)
        dados2019 <- bind_rows(dados2019, dadosTMP)
}
```

O Balanço Anual por Centro de Custo está apresentado na tabela seguinte:

```{r Balanço Anual por CC}

dados2019_by_CC <- dados2019 %>% group_by(CENTRO.DE.CUSTO)
balancoAnualCC <- dados2019_by_CC %>% summarise(Valores = sum(IMPORTÂNCIA))
knitr::kable(balancoAnualCC)
```

A soma de todos os valores, por Centro de Custo é de `r as.integer(sum(balancoAnualCC$Valores))`€, sendo este valor negativo devido à perda da principal fonte de rendimento da Sociedade União Sontrense: o aluguer do andar inferior.   

## Balanço de Atividades por Rubrica   

De uma forma mais clara, demonstra-se na seguinte tabela como é que cada rúbrica influencia a tendencia de cada centro de custo positiva ou negativamente.   

```{r Balanço Anual por CC e Rubrica}
dados2019_by_CC_Rubri <- dados2019 %>% group_by(CENTRO.DE.CUSTO, RUBRICA)
balancoAnualCC_Rubri <- dados2019_by_CC_Rubri %>% summarise(Valores = sum(IMPORTÂNCIA))
knitr::kable(balancoAnualCC_Rubri)
```

